var Picture={transformOriginal:function(a,b,c){b.onload=function(){a.canvas.width=window.innerWidth,a.canvas.height=window.innerHeight,a.drawImage(b,0,0,a.canvas.width,a.canvas.height);var c=a.getImageData(0,0,a.canvas.width,a.canvas.height),d=Picture.setDuotone(c);Picture.currentImageData=d,a.putImageData(d,0,0)},b.crossOrigin="Anonymous",b.src=c},setDuotone:function(a){for(var b=0;b<a.data.length;b+=4){var c=Pixel.brightness(a.data[b],a.data[b+1],a.data[b+2]),d=c/255,e=1-d,f=[d*ComplementaryColors.color1[0],0,0],g=[0,e*ComplementaryColors.color2[1],0],h=ComplementaryColors.duotoneColorRgb(f,g);a.data[b]=h[0],a.data[b+1]=h[1],a.data[b+2]=h[2]}return Picture.duotoneImageDataArray=a.data.slice(0),a},transitionToDarkerColor:function(){for(var a=ComplementaryColors.color1,b=ComplementaryColors.color2,c=a[0]/b[1],d=0;d<Picture.currentImageData.data.length;d+=4)Picture.currentImageData.data[d]+=c,Picture.currentImageData.data[d+1]-=c;var e=document.getElementById("palm-canvas"),f=e.getContext("2d");f.putImageData(Picture.currentImageData,0,0)},transitionToDuotone:function(){for(var a=ComplementaryColors.color1,b=ComplementaryColors.color2,c=a[0]/b[1],d=0;d<Picture.currentImageData.data.length;d+=4)Picture.currentImageData.data[d]===Picture.duotoneImageDataArray[d]&&Picture.currentImageData.data[d+1]===Picture.duotoneImageDataArray[d+1]||(Picture.currentImageData.data[d]>Picture.duotoneImageDataArray[d]?Picture.currentImageData.data[d]-=c:Picture.currentImageData.data[d]<Picture.duotoneImageDataArray[d]&&(Picture.currentImageData.data[d]+=c),Picture.currentImageData.data[d+1]>Picture.duotoneImageDataArray[d+1]?Picture.currentImageData.data[d+1]-=c:Picture.currentImageData.data[d+1]+=c);var e=document.getElementById("palm-canvas"),f=e.getContext("2d");f.putImageData(Picture.currentImageData,0,0)}},ComplementaryColors={setColors:function(a,b){ComplementaryColors.color1=a,ComplementaryColors.color2=b},duotoneColorRgb:function(a,b){var c=[];for(var d in a){var e=a[d]+b[d];c.push(e)}return c}},Pixel={brightness:function(a,b,c){var d=(a+b+c)/3;return d}},Keyboard={checkKey:function(a){a.preventDefault(),39==a.keyCode?Picture.transitionToDarkerColor():37==a.keyCode&&Picture.transitionToDuotone()}};$(document).ready(function(a){var b="http://stephaniekwak.com/misc/palmtree.jpg",c=document.getElementById("palm-canvas"),d=c.getContext("2d"),e=new Image;ComplementaryColors.setColors([255,0,0],[0,128,0]),Picture.transformOriginal(d,e,b),document.addEventListener("keydown",function(a){Keyboard.checkKey(a)})});